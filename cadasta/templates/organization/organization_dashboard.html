{% extends "core/base.html" %}

{% load i18n %}
{% load widget_tweaks %}
{% load staticfiles %}

{% block title %} | {{ object.name }}{% endblock %}

{% block content %}

<div class="row">
  <div class="col-sm-8">
    <h1 class="dashboard-org-name">{{ object.name }}</h1>
  </div>
</div>

<div class="row">
  <div class="col-sm-8">
    <h2>{% trans "Dashboard" %}</h2>
  </div>
  <div class="col-sm-4">
    <a class="edit" href="{% url 'organization:edit' object.slug %}">
      {% trans "Edit" %}
    </a> |
    {% if object.archived %}
    <a class="archive" href="#unarchive_confirm" data-toggle="modal">
      {% trans "Unarchive" %}
    </a>
    {% else %}
    <a class="archive" href="#archive_confirm" data-toggle="modal">
      {% trans "Archive" %}
    </a>
    {% endif %}
  </div>
</div>

<div class="row">
  <div class="col-sm-8 org-proj-list">
    {% if object.projects.all  %}
    <table class="table table-hover datatable" data-paging-type="simple">
      <thead>
        <tr>
          <th class="col-md-6">{% trans "Project" %}</th>
          <th class="col-md-2">{% trans "Country" %}</th>
          <th class="col-md-2">{% trans "Last updated" %}</th>
        </tr>
      </thead>
      <tbody>
        {% for prj in object.projects.all %}
        <tr onclick="window.document.location='{% url 'organization:project-dashboard' organization=object.slug project=prj.project_slug %}';">
          <td>{{ prj.name }}</td>
          <td>{{ prj.country }}</td>
          <td>{{ prj.last_updated }}</td>
        </tr>
        <div>{{ prj.name }}</div>
        {% empty %}

        {% endfor %}
      </tbody>
    </table>
    {% else %}
    <h4>{% trans "You're ready to go" %}</h4>
    <p>
      {% trans "You have successfully created your organization." %}
      {% trans "What would you like to do next?" %}
    </p>
    <p>
      <a href="{% url 'project:add' %}" class="btn btn-default add-new-project">
        {% trans "Add new project" %}
      </a>
      <a href="#" class="btn btn-default add-members">
        {% trans "Add members" %}
      </a>
    </p>
    {% endif %}
  </div>
  <div class="col-sm-4 org-desc-members">
    {{ object.description }}

    <h4>{% trans "Members" %}</h4>
    {% for user in object.users.all %}
    <b>{{ user.get_full_name }}</b><br>
    {% trans "Username" %}: {{ user.username }}
    <hr>
    {% endfor %}
    <a href="{% url 'organization:members' object.slug %}"
       class="btn btn-default view-all">
      {% trans "View all" %}
    </a>
    </div>
</div>

<div class="modal fade" id="archive_confirm" tabindex="-1" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal"
                aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
        <h4 class="modal-title">{% trans "Archive organization" %}</h4>
      </div>
      <div class="modal-body">
        <p>
          {% trans "Are you sure you want to archive this organization?" %}
        </p>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-link cancel" data-dismiss="modal">
          {% trans "Cancel" %}
        </button>
        <a href="{% url 'organization:archive' object.slug %}"  class="btn btn-primary archive-final">
          {% trans "Archive" %}
        </a>
      </div>
    </div><!-- /.modal-content -->
  </div><!-- /.modal-dialog -->
</div><!-- /.modal -->

<div class="modal fade" id="unarchive_confirm" tabindex="-1" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close-u" data-dismiss="modal"
                aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
        <h4 class="modal-title">{% trans "Unarchive organization" %}</h4>
      </div>
      <div class="modal-body">
        <p>
          {% trans "Are you sure you want to unarchive this organization?" %}
        </p>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-link cancel-u" data-dismiss="modal">
          {% trans "Cancel" %}
        </button>
        <a href="{% url 'organization:unarchive' object.slug %}"  class="btn btn-primary unarchive-final">
          {% trans "Unarchive" %}
        </a>
      </div>
    </div><!-- /.modal-content -->
  </div><!-- /.modal-dialog -->
</div><!-- /.modal -->

{% endblock %}
