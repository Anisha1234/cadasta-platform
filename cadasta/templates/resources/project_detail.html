{% extends "organization/project_wrapper.html" %}
{% load i18n %}

{% block page_title %}Resource detail | {% endblock %}
{% block left-nav %}resources{% endblock %}

{% block content %}

<div class="col-md-12 content-single">
  <div class="row">
    <!-- Main text  -->
    <div class="col-md-12 main-text">
      <div class="page-title">
        <h2>{% trans "Resource detail" %}</h2>
      </div>
      <div class="panel panel-default">
        <div class="panel-body">
          <img src="{{ resource.thumbnail }}" class="thumb-128">
          <h4>{{ resource.name }}</h4>
          <p>{{ resource.description }}<br><strong>{{ resource.file_name }}</strong></p>
          <p class="small">{% blocktrans with date=resource.last_updated user=resource.contributor.full_name %}Added on {{ date }} by {{ user }}{% endblocktrans %}</p>
          <ul class="list-inline resource-actions">
            <li>
              <a href="{% url 'resources:project_edit' object.organization.slug object.slug resource.id %}?next={{ request.META.HTTP_REFERER }}">Edit resource</a>
            </li>
            <li>
              {% if resource.archived %}
              <a href="#unarchive_resource_confirm" data-toggle="modal">Unarchive resource</a>
              {% else %}
              <a href="#archive_resource_confirm" data-toggle="modal">Archive resource</a>
              {% endif %}
            </li>
          </ul>
          </div>
          <div class="panel-footer panel-buttons">
            <a href="{{ resource.file.url }}" class="btn btn-primary" download>Download</a>
            <a href="{{ request.META.HTTP_REFERER }}" class="btn btn-default">Cancel</a>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

{% endblock %}

{% block modals %}

<div class="modal fade" id="archive_resource_confirm" tabindex="-1" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
        <h3 class="modal-title">{% trans "Archive resource" %}</h3>
      </div>
      <div class="modal-body">
        <p>{% trans "Are you sure you want to archive this resource?" %}</p>
      </div>
      <div class="modal-footer">
        <a href="{% url 'resources:archive' object.organization.slug object.slug resource.id %}?next={{ request.META.HTTP_REFERER }}"  class="btn btn-danger archive-final pull-right" role="button">
          {% trans "Yes, archive this resource" %}
        </a>
        <button type="button" class="btn btn-link cancel" data-dismiss="modal">
          {% trans "Cancel" %}
        </button>
      </div>
    </div><!-- /.modal-content -->
  </div><!-- /.modal-dialog -->
</div><!-- /.modal -->

<div class="modal fade" id="unarchive_resource_confirm" tabindex="-1" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
        <h3 class="modal-title">{% trans "Unarchive resource" %}</h3>
      </div>
      <div class="modal-body">
        <p>
          {% trans "Are you sure you want to unarchive this resource?" %}
        </p>
      </div>
      <div class="modal-footer">
        <a href="{% url 'resources:unarchive' object.organization.slug object.slug resource.id %}?next={{ request.META.HTTP_REFERER }}"  class="btn btn-primary unarchive-final pull-right" role="button">
          {% trans "Yes, unarchive this resource" %}
        </a>
        <button type="button" class="btn btn-link cancel cancel-u" data-dismiss="modal">
          {% trans "Cancel" %}
        </button>
      </div>
    </div><!-- /.modal-content -->
  </div><!-- /.modal-dialog -->
</div><!-- /.modal -->

{% endblock %}
